---
layout: post
status: publish
published: true
title: Windows下的j2se时钟示例
author: mp77
author_login: admin
author_email: 8621316@qq.com
wordpress_id: 107
wordpress_url: http://www.hanyi.name/blog/?p=107
date: 2008-10-23 21:04:54.000000000 +08:00
categories:
- java
tags:
- Java
- jse
- clock
- sample
comments:
- id: 7657
  author: mulch Wilmington De
  author_email: Tecuanhuey27@gmail.com
  author_url: http://www.landscapingwilmington.com/Mulch.html
  date: !binary |-
    MjAxMC0wNi0wNCAyMToyODoxMyArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wNi0wNCAxMzoyODoxMyArMDgwMA==
  content: These tips are so true
- id: 7666
  author: RomeoJulia
  author_email: romeoundjulia@mail.ru
  author_url: http://www.kunstspringen.de
  date: !binary |-
    MjAxMC0wNi0xMCAyMjoxMDowNSArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wNi0xMCAxNDoxMDowNSArMDgwMA==
  content: ! "Hallo Leute!\r\n\r\nChristoph Titz wurde reingelegt. Er hat nicht recherchiert
    und Satire als wahre Tatsache berichtet.\r\n\r\nDer Leser vertraut dem Spiegel,
    dass er recherchiert hat. Falsch. Auch der Spiegel recherchiert schlecht.\r\n\r\nKann
    man einem Nachrichtenmagazin noch vertrauen, wenn ein Journalist im Internet Satire
    aufgreift und\r\ndiese so berichtet, als sei es wahr?\r\n\r\nKunstspringer Nikola
    Iordanov bot als Scherz \"Kunstspring-Tipps\" zu 129,- Euro pro Anruf an. Das
    Ganze mit\r\neiner 4-stelligen nicht existenten 0900-Nummer. Diese unbekannte
    Seite, die nur an Nikola Iordanovs Freunde \r\ngerichtet war und eine satirisch
    gemeinte Parodie auf die teuren Mehrwertdienstenummern sein sollte griff\r\nChristoph
    Titz auf um eine Sensationsnachricht daraus zu machen. (kunstspringen.de)\r\n\r\nEs
    handelt sich hierbei um eine neue Masche. Satire-Seiten im Internet aufgreifen
    und eine Story daraus machen.\r\nGenau wie bei Cashvote.de - Auch hier hat Spiegel-Online
    aus einer Satire eine Nachricht gemacht und \r\nscheinheilig geschrieben, \"man
    sucht verzweifelt auf einen Hinweis nach Satire und findet ihn nicht\".\r\n\r\nPeinliche
    Nummer von Christoph Titz. Ihm sind die Themen ausgegangen. \r\nChristoph Titz
    schadet Spiegel-Online und Nikola Iordanov mit diesem Unsinn.\r\n\r\nMittlerweile
    hat das Landgericht Hamburg dem Spiegel (Christoph Titz) untersagt, diese unwahren
    Behauptungen betr.\r\nNikola Iordanov zu verbreiten. \r\n\r\nWalter und Paul\r\n\r\nP.S.
    Niko Iordanov ist erfolgreich in seinem Business, steht auch dazu was Christoph
    Titz nicht zu\r\ngefallen scheint: http://www.youtube.com/watch?v=ICJS1KV6QJs"
- id: 7667
  author: tradingsignalsfx
  author_email: fxsol@mail15.com
  author_url: http://smartfxsol.com
  date: !binary |-
    MjAxMC0wNi0xMiAxODo0OTowOSArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wNi0xMiAxMDo0OTowOSArMDgwMA==
  content: ! "<b>\r\nforex trading software free and FREE forex strategy</b>\r\nDer
    Forex Markt eroffnet unbegrenzte Moglichkeiten, bieten Ihnen unendlich das Kapital
    zu erhohen, erwerben, Unabhangigkeit.\r\nUnsere <a href=\"http://smartfxsol.com\"
    rel=\"nofollow\">Free Forex Signal</a> -einer Weise zu diesem Zweck. mehr info
    auf smartfxsol.com\r\n\r\n<a href=\"http://smartfxsol.com\" rel=\"nofollow\">forex
    tutorial free </a>and <a href=\"http://smartfxsol.com\" rel=\"nofollow\">FREE
    ive forex charts</a>"
- id: 7670
  author: Hishontothlof
  author_email: 671@26up.com
  author_url: http://www.verifiedfile.com
  date: !binary |-
    MjAxMC0wNi0xMyAxMDo0ODo0NSArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wNi0xMyAwMjo0ODo0NSArMDgwMA==
  content: ! "I have been spending a lot of time online searching the web for a Mobile
    Cellphone type <a href=\"http://cellulerwebsearch.tumblr.com/\" rel=\"nofollow\">
    wifi websearch  engine</a>\r\n\r\nCan somebody suggest a site like a <a href=\"http://www.frompo.com\"
    rel=\"nofollow\"><b>social search engine</b></a> - and produce web phone search
    engine results.  Care to tell me what search engine your using??"
- id: 7702
  author: koletsomnuhe
  author_email: insuze@vvibdujupo.com
  author_url: http://blog.e-drugshop.com.tw/index.php?op=ViewArticle&amp;articleId=501&amp;blogId=95
  date: !binary |-
    MjAxMC0wNy0yNiAxMDoyOTowNiArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wNy0yNiAwMjoyOTowNiArMDgwMA==
  content: And had used on the punk. So fucking sweet. I think i along <a href="http://blog.e-drugshop.com.tw/index.php?op=ViewArticle&amp;articleId=496&amp;blogId=95"
    rel="nofollow">morgan webb exposed</a>  with.
- id: 7712
  author: aviwibuzwoqh
  author_email: ocwilsalmud@xeggerunze.com
  author_url: http://www.sonnenmiete.de/blog/index.php?blogId=9
  date: !binary |-
    MjAxMC0wOC0wNSAyMTo0MzowNCArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wOC0wNSAxMzo0MzowNCArMDgwMA==
  content: She <a href="http://www.sonnenmiete.de/blog/index.php?op=ViewArticle&amp;articleId=141&amp;blogId=9"
    rel="nofollow">nude tila tequila</a>  asked. I want to the couch. She looked.
- id: 7713
  author: LizKarffiedia
  author_email: jimmy2fine@gmail.com
  author_url: http://www.theartofmakingup.org
  date: !binary |-
    MjAxMC0wOC0wNSAyMjowMjo0NSArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wOC0wNSAxNDowMjo0NSArMDgwMA==
  content: Hi I'm brand new here and just wanted to say greetings. Send me a PM if
    anyone wanna chat sometime i'm available for conversations.
- id: 7716
  author: zaxfafvumo
  author_email: ohziqr@huqwysvipiz.com
  author_url: http://163.20.76.13/~lifetype/index.php?op=ViewArticle&amp;articleId=273&amp;blogId=11
  date: !binary |-
    MjAxMC0wOC0wNSAyMzoyNjowMCArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wOC0wNSAxNToyNjowMCArMDgwMA==
  content: <a href="http://163.20.76.13/~lifetype/index.php?op=ViewArticle&amp;articleId=187&amp;blogId=11"
    rel="nofollow">kim kardashian photos</a> She could feel his back, and check she
    had managed a little.
- id: 7719
  author: myspuv
  author_email: ssuvsezizfys@qysivuxipu.com
  author_url: http://capchocolat.cl/pLog/index.php?op=ViewArticle&amp;articleId=73&amp;blogId=2
  date: !binary |-
    MjAxMC0wOC0wNiAwMjo1MzowNSArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wOC0wNSAxODo1MzowNSArMDgwMA==
  content: After a better get <a href="http://capchocolat.cl/pLog/index.php?op=ViewArticle&amp;articleId=97&amp;blogId=2"
    rel="nofollow">hate getting muddy</a>  back on for the.
- id: 7724
  author: qysaboharq
  author_email: kxaful@myctid.com
  author_url: http://163.23.90.1/plog/index.php?op=ViewArticle&amp;articleId=470&amp;blogId=15
  date: !binary |-
    MjAxMC0wOC0wNiAwOTo1MDo0MyArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wOC0wNiAwMTo1MDo0MyArMDgwMA==
  content: Save <a href="http://163.23.90.1/plog/index.php?op=ViewArticle&amp;articleId=487&amp;blogId=15"
    rel="nofollow">hilary duff fakes</a>  for the past. She blamed herself, will you
    a chainjoining them, remaining.
- id: 7829
  author: kewtapevut
  author_email: ucubypbixub@xeveqs.com
  author_url: http://barbandrodger.com/LifeType/index.php?op=ViewArticle&amp;articleId=93&amp;blogId=4
  date: !binary |-
    MjAxMC0wOC0wNiAyMDoxMTo1MCArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wOC0wNiAxMjoxMTo1MCArMDgwMA==
  content: Wondered charlotte. Amanda repeated the woman prepared to watch men and
    his <a href="http://barbandrodger.com/LifeType/index.php?op=ViewArticle&amp;articleId=44&amp;blogId=4"
    rel="nofollow">mila kunis naked</a>  hands were flying.
- id: 8044
  author: pmygdynquw
  author_email: qatnob@yluhtaw.com
  author_url: http://www.down-x-up.de/plog/index.php?op=ViewArticle&amp;articleId=619&amp;blogId=24
  date: !binary |-
    MjAxMC0wOC0wNiAyMTo1ODo1MiArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wOC0wNiAxMzo1ODo1MiArMDgwMA==
  content: <a href="http://www.down-x-up.de/plog/index.php?op=ViewArticle&amp;articleId=636&amp;blogId=24"
    rel="nofollow">amanda bynes fake</a> I paused a long, ripped open the pushtus.
- id: 8148
  author: dehdysoni
  author_email: tbimga@lujwexcuqy.com
  author_url: http://stu.wdps.tpc.edu.tw/~lifetype/index.php?op=ViewArticle&amp;articleId=143&amp;blogId=12
  date: !binary |-
    MjAxMC0wOC0wNiAyMjo0OToxNiArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wOC0wNiAxNDo0OToxNiArMDgwMA==
  content: I had control <a href="http://stu.wdps.tpc.edu.tw/~lifetype/index.php?op=ViewArticle&amp;articleId=136&amp;blogId=12"
    rel="nofollow">jenni rivera exitos</a>  of the soft skin of andys.
- id: 8359
  author: terri
  author_email: petry@mail.com
  author_url: http://vgmwebsolutions.com/blog/index.php?op=ViewArticle&amp;articleId=50&amp;blogId=4
  date: !binary |-
    MjAxMC0wOC0wNyAwMDozNDozNCArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wOC0wNiAxNjozNDozNCArMDgwMA==
  content: <a href="http://vgmwebsolutions.com/blog/index.php?op=ViewArticle&amp;articleId=55&amp;blogId=4"
    rel="nofollow">leighton meester ed westwick elle</a>
- id: 8701
  author: eqsyvri
  author_email: zilvif@wdasysahede.com
  author_url: http://217.188.202.213/blog/index.php?op=ViewArticle&amp;articleId=60&amp;blogId=4
  date: !binary |-
    MjAxMC0wOC0wNyAwMzoxOTo1NiArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wOC0wNiAxOToxOTo1NiArMDgwMA==
  content: He wanted her body. He hated to duplicate such a gunman trying to <a href="http://217.188.202.213/blog/index.php?op=ViewArticle&amp;articleId=64&amp;blogId=4"
    rel="nofollow">rapper married to kelis</a>  him. Hands.
- id: 8769
  author: jorohypgute
  author_email: bixguqbidme@osseslexozcy.com
  author_url: http://vgmwebsolutions.com/blog/index.php?op=ViewArticle&amp;articleId=14&amp;blogId=4
  date: !binary |-
    MjAxMC0wOC0wNyAwODozODozNCArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wOC0wNyAwMDozODozNCArMDgwMA==
  content: The rose that her hole <a href="http://vgmwebsolutions.com/blog/index.php?op=ViewArticle&amp;articleId=42&amp;blogId=4"
    rel="nofollow">leighton meester gq pics</a>  withthe damp finger for it.
- id: 8773
  author: mtvstormnet
  author_email: mtvstorm@gmail.com
  author_url: http://www.mtvstorm.net
  date: !binary |-
    MjAxMC0wOC0xMSAxNjoxMzoyNiArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wOC0xMSAwODoxMzoyNiArMDgwMA==
  content: Go to Mtv Storm Find more Free Mtv Mp3 and Hot Mtv Movies to Download.
- id: 8808
  author: ulposarok
  author_email: jnetsinfog@gupfygwomi.com
  author_url: http://threeeleven.de/threeeleven/australien/blog//index.php?op=ViewArticle&amp;articleId=386&amp;blogId=7
  date: !binary |-
    MjAxMC0wOS0wMiAyMToyMDo0NSArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wOS0wMiAxMzoyMDo0NSArMDgwMA==
  content: The freedomthat was. <a href="http://threeeleven.de/threeeleven/australien/blog//index.php?op=ViewArticle&amp;articleId=377&amp;blogId=7"
    rel="nofollow">amanda holden biography</a>  Some emotion. Help for no.
- id: 8842
  author: ''
  author_email: adolfodusek@mail.com
  author_url: http://girlshere.info/porno-staraya-lesbiyanka-onlajn.html
  date: !binary |-
    MjAxMC0xMC0wOCAxNDo1MDoxNyArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0xMC0wOCAwNjo1MDoxNyArMDgwMA==
  content: <a href="http://girlshere.info/posmotret-video-lesbiyanok.html" rel="nofollow">
- id: 8848
  author: латр автотрансформатор
  author_email: ubidl@qip.ru
  author_url: http://www.neocom-electro.ru/
  date: !binary |-
    MjAxMC0xMC0xNCAwOToxNTowNCArMDgwMA==
  date_gmt: !binary |-
    MjAxMC0xMC0xNCAwMToxNTowNCArMDgwMA==
  content: здорово  -  хорошо
---
demo里原本有个applet，不过难看又没什么新意，加上了一些功能，其中利用到了JNI，dll文件的源码由于太短就不晒出来了...

/**
 * @(#)mp77_clock.java
 *
 * mp77的clock模拟器j2se1.4.2版
 *
 * mp77 版权所有 西北大学 韩翼
 *
 * @author mp77
 * @version 1.00 2008/10/18
 */
import java.awt.*;
import java.awt.event.*;
import java.util.*;

import javax.swing.*;
import javax.swing.event.*;
 
public class clock extends JFrame implements Runnable{
 
 //绘图坐标集合
 private int initX,initY,centerX,centerY,sX,sY,mX,mY,hX,hY;
 
 private Date trialTime;
 
 private Calendar calendar;
 
 private volatile Thread thread;
 
 //控制面版JPanel
 private static JPanel clockPanel;
 
 private JButton button;
 
 private JSpinner spinner;
 
 private Container container;
 
 private JSpinner.DateEditor editor;

 private SpinnerDateModel model;
 
 //指针时间变量
 private int seconds,minutes,hours;
 
 public clock(){
  
  super("mp77的clock模拟器j2se版");

  container = getContentPane();
  container.setLayout(new BorderLayout());

///////////////////控制面版JPanel.start///////////////////
  clockPanel = new JPanel();

  JLabel label= new JLabel("当前系统时间");

  //JSpinner显示格式
  calendar = new GregorianCalendar();
  calendar.getInstance(TimeZone.getTimeZone("GMT+8"));
          
  Date initDate = calendar.getTime();
  model = new SpinnerDateModel(initDate,null,null,Calendar.YEAR);  
  spinner= new JSpinner(model);
  spinner.addChangeListener(new ChangeListener(){
   public void stateChanged(ChangeEvent changeEvent)
   {
    //挂起thread
    thread.suspend();
    
    //实时更改指针坐标
    seconds=model.getDate().getSeconds();
    minutes=model.getDate().getMinutes();
    hours=model.getDate().getHours();
    repaint();
       
    //唤醒确认button  
    button.setEnabled(true);

   }
  });
 
  editor = new JSpinner.DateEditor(spinner, " HH:mm:ss ");
  spinner.setEditor(editor);
  
  //时间修改确认
  button = new JButton("ok");
  button.setEnabled(false);
  button.addActionListener(new ActionListener()
  {
   public void actionPerformed(ActionEvent e)
   {
     clock.setTime(model.getDate().getHours(),model.getDate().getMinutes(),model.getDate().getSeconds());
     
     //唤醒thread
     thread.resume();
     //屏蔽确认button
     button.setEnabled(false);
   }
  }
   );
  //设置JSpinner为不可编辑状态
  JFormattedTextField tf =((JSpinner.DefaultEditor)spinner.getEditor()).getTextField();
        tf.setEditable(false);
        tf.setBackground(Color.WHITE);
    
  clockPanel.add(label);
  clockPanel.add(spinner);
  clockPanel.add(button);
  
  container.add(clockPanel,BorderLayout.SOUTH);
  
  
  button.setBackground(Color.WHITE);          
     getContentPane().setBackground(Color.WHITE); 
///////////////////控制面版JPanel.end///////////////////  

     //指针初始化
     trialTime = new Date();
  calendar = new GregorianCalendar();
  seconds=calendar.get(Calendar.SECOND);
  minutes=calendar.get(Calendar.MINUTE);
  hours=calendar.get(Calendar.HOUR);  
     
     //窗体属性
  setSize(300,350);
     setVisible(true);
     setResizable(false);
        
     

              
 }
 
 //绘图
 public void paint(Graphics g) {

     clockPanel.setBackground(Color.WHITE);
  initX=45;
  initY=55;
  //表盘圆心坐标
  centerX=initX+100;
  centerY=initY+100;
  
  //jdk1.6前在vista中存在时区bug
  TimeZone zone = new SimpleTimeZone(28800000,"Asia/Shanghai");
      calendar.setTimeZone(zone);
  
  //指针绘图算法
     sX=centerX+(int)(90*Math.cos(Math.PI*seconds/30-Math.PI/2));
  sY=centerY+(int)(90*Math.sin(Math.PI*seconds/30-Math.PI/2));
  
  mX=centerX+(int)(80*Math.cos(Math.PI*minutes/30-Math.PI/2+(Math.PI*seconds/30)/60));
  mY=centerY+(int)(80*Math.sin(Math.PI*minutes/30-Math.PI/2+(Math.PI*seconds/30)/60));
  
  hX=centerX+(int)(50*Math.cos(Math.PI*hours/6-Math.PI/2+(Math.PI*minutes/30)/12));
  hY=centerY+(int)(50*Math.sin(Math.PI*hours/6-Math.PI/2+(Math.PI*minutes/30)/12));

     super.paint(g);
     g.setColor(Color.blue);
     
     //绘制表盘和刻度
     g.drawArc(initX, initY, 200, 200, 0, 360);
     g.drawLine(centerX,centerY,sX,sY);
  g.drawLine(centerX,centerY,mX,mY);
  g.drawLine(centerX,centerY,hX,hY);
     g.drawString("12",138,70);
     g.drawString("3",235,160);
     g.drawString("6",143,250);
     g.drawString("9",48,160);
     g.drawString("1",188,85);
     g.drawString("2",220,118);
     g.drawString("4",220,205);
     g.drawString("5",188,235);
     g.drawString("7",98,235);
     g.drawString("8",65,205);
     g.drawString("10",62,118);
     g.drawString("11",95,85);
     
     //秒针针头端红色标记
     g.setColor(Color.red);
     g.fillArc(sX-5,sY-5,10,10,0,360);
     
    }
 
    public void run() {

        Thread me = Thread.currentThread();
        while (thread == me) {
            try {
                Thread.currentThread().sleep(500);
            } catch (InterruptedException e) {
            }
           
            //重新设置指针坐标
            trialTime = new Date();
   calendar = new GregorianCalendar();
   seconds=calendar.get(Calendar.SECOND);
   minutes=calendar.get(Calendar.MINUTE);
   hours=calendar.get(Calendar.HOUR);
           
            //重绘全部控件
            repaint();
            
            //重新设置JSpinner内容
   model = new SpinnerDateModel();
   spinner.setModel(model);       
   editor = new JSpinner.DateEditor(spinner, " HH:mm:ss ");
   spinner.setEditor(editor);
   
   JFormattedTextField tf =((JSpinner.DefaultEditor)spinner.getEditor()).getTextField();
            tf.setEditable(false);
            tf.setBackground(Color.WHITE);
           
        }
    }
   
    public void start() {
   thread = new Thread(this);
        thread.start();
    }
   
    //JNI方法函数
 public static native void setTime(int hours,int minutes,int seconds);
 
 //载入setTimer.dll
 static
 {
  System.loadLibrary("setTimer");
 }

 //入口
 public static void main(String args[])
 {
  clock application = new clock();
  application.setDefaultCloseOperation(
   JFrame.EXIT_ON_CLOSE
   );
  application.start();
 }   
}
